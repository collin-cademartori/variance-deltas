data {
  int N
  int K
  array[N, K] y
  int P
}

parameters {
  array[P, K] y_pot
  array[K] theta
  real mu
}

model {
  for(k in 1:K) {
    theta[k] ~ normal(mu)
    for(n in 1:N) {
      y[n, k] ~ normal(theta[k])
    }
    for(p in 1:P) {
      y_pot[p, k] ~ normal(theta[k])
    }
  }
  mu ~ normal(0,1)
}

tree {
  for(k in 1:K) {
    leaf(y_pot[1:P, k])
  }
  root(mu)
}